import{A as O}from"./AdminLayout-DTcn9miB.js";import{d as q,H as Y,r as w,q as J,p as K,a as m,c as u,o as d,w as i,b as s,e,h as c,i as l,k as b,t as n,F as E,j as G}from"./app-Ckp5YMnG.js";import"./useTheme-B1awz47X.js";const M={class:"d-flex justify-end mb-4 no-print"},Q={key:0,style:{height:"600px"}},W=["src"],X={key:1,class:"pa-8 text-center"},Z={class:"mb-4"},tt={class:"text-h6 text-uppercase"},et={class:"text-caption text-grey"},it={class:"text-h5 font-weight-bold text-success"},st={class:"d-flex justify-space-between align-center"},ot={class:"text-h6 mt-2"},nt={class:"text-right"},lt={class:"mb-6"},at={class:"text-h6 mb-3 d-flex align-center"},dt={class:"text-body-1 font-weight-bold"},rt={class:"text-body-1"},mt={class:"text-body-1"},ct={class:"text-h6 text-primary font-weight-bold"},ut={class:"text-h6 text-success font-weight-bold"},vt={class:"text-h6 text-warning font-weight-bold"},yt={class:"text-body-1"},ft={class:"mb-6"},xt={class:"text-h6 mb-3 d-flex align-center"},bt={class:"text-body-1 font-weight-bold"},gt={class:"text-body-1"},pt={class:"text-body-1"},wt={key:0,class:"mb-6"},kt={class:"text-h6 mb-3 d-flex align-center"},Nt={class:"text-body-1 font-weight-bold"},Pt={class:"text-body-1"},Rt={class:"text-body-1"},At={class:"mb-6"},It={class:"text-h6 mb-3 d-flex align-center"},Ct={class:"text-body-1 font-weight-medium"},_t={class:"text-body-1 font-weight-medium"},St={class:"text-body-1 font-weight-medium"},Dt={class:"text-body-1"},Et={key:1},Gt={class:"text-h6 mb-3 d-flex align-center"},ht=q({__name:"Show_old",props:{invoice:{}},setup(o){const V=o,z=Y(),R=w(!1),k=w(!1),A=w(""),I=w(""),g=w(""),L=J(()=>{try{return new URL(A.value),!0}catch{return!1}});K(()=>z.props.flash?.paymentData,r=>{r&&(A.value=r.link||r.reference||"",I.value=r.reference||"",g.value=r.gateway||"",k.value=!0)},{immediate:!0});const h=()=>{R.value=!0,G.post(route("admin.invoices.initiate-payment",V.invoice.id),{},{onFinish:()=>{R.value=!1}})},U=()=>{k.value=!1,G.reload()},B=()=>{navigator.clipboard.writeText(I.value),alert("Reference copied to clipboard!")},T=[{title:"Reference",key:"reference"},{title:"Amount",key:"amount"},{title:"Status",key:"status"},{title:"Date",key:"payment_date"},{title:"Gateway",key:"gateway"}],N=r=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(r),S=r=>({PAID:"success",PENDING:"warning",PARTIALLY_PAID:"info",CANCELLED:"error"})[r]||"grey";return(r,t)=>{const x=m("v-btn"),D=m("v-card-title"),f=m("v-icon"),P=m("v-divider"),C=m("v-card-text"),_=m("v-card"),j=m("v-alert"),F=m("v-dialog"),y=m("v-chip"),a=m("v-col"),p=m("v-row"),H=m("v-data-table"),$=m("v-container");return d(),u(O,null,{default:i(()=>[s($,{fluid:""},{default:i(()=>[s(p,null,{default:i(()=>[s(a,{cols:"12"},{default:i(()=>[e("div",M,[o.invoice.payment_status==="PAID"?(d(),u(x,{key:0,color:"primary","prepend-icon":"mdi-printer",class:"mr-2",onClick:r.printReceipt},{default:i(()=>[...t[3]||(t[3]=[l(" Print Receipt ",-1)])]),_:1},8,["onClick"])):c("",!0),o.invoice.payment_status!=="PAID"&&o.invoice.giras.synced?(d(),u(x,{key:1,color:"success","prepend-icon":"mdi-credit-card",class:"mr-2",onClick:h,loading:R.value},{default:i(()=>[...t[4]||(t[4]=[l(" Pay Now ",-1)])]),_:1},8,["loading"])):c("",!0),o.invoice.payment_status!=="PAID"?(d(),u(x,{key:2,color:"primary","prepend-icon":"mdi-pencil",class:"mr-2",onClick:t[0]||(t[0]=v=>r.$inertia.visit(r.route("admin.invoices.edit",o.invoice.id)))},{default:i(()=>[...t[5]||(t[5]=[l(" Edit ",-1)])]),_:1})):c("",!0),s(x,{variant:"text","prepend-icon":"mdi-arrow-left",onClick:t[1]||(t[1]=v=>r.$inertia.visit(r.route("admin.invoices.index")))},{default:i(()=>[...t[6]||(t[6]=[l(" Back ",-1)])]),_:1})]),s(F,{modelValue:k.value,"onUpdate:modelValue":t[2]||(t[2]=v=>k.value=v),"max-width":"900",persistent:"",class:"no-print"},{default:i(()=>[s(_,null,{default:i(()=>[s(D,{class:"d-flex justify-space-between align-center bg-success"},{default:i(()=>[t[7]||(t[7]=e("span",{class:"text-white"},"Payment Gateway",-1)),s(x,{icon:"mdi-close",variant:"text",color:"white",onClick:U})]),_:1}),s(C,{class:"pa-0"},{default:i(()=>[L.value?(d(),b("div",Q,[e("iframe",{src:A.value,style:{width:"100%",height:"100%",border:"none"},title:"Payment Gateway"},null,8,W)])):(d(),b("div",X,[s(f,{size:"64",color:"success",class:"mb-4"},{default:i(()=>[...t[8]||(t[8]=[l("mdi-check-circle",-1)])]),_:1}),t[13]||(t[13]=e("h2",{class:"text-h5 mb-4"},"Payment Reference Generated",-1)),s(_,{variant:"outlined",class:"mb-4"},{default:i(()=>[s(C,null,{default:i(()=>[e("div",Z,[t[9]||(t[9]=e("div",{class:"text-caption text-grey"},"Gateway",-1)),e("div",tt,n(g.value),1)]),s(P,{class:"my-4"}),e("div",null,[e("div",et,n(g.value==="remita"?"RRR Number":"Reference"),1),e("div",it,n(I.value),1)])]),_:1})]),_:1}),s(j,{type:"info",variant:"tonal",class:"text-left"},{default:i(()=>[g.value==="remita"?(d(),b(E,{key:0},[t[10]||(t[10]=e("strong",null,"How to Pay:",-1)),t[11]||(t[11]=e("ol",{class:"mt-2"},[e("li",null,"Visit any bank or use your bank's mobile app"),e("li",null,'Select "Remita Payment"'),e("li",null,"Enter the RRR number above"),e("li",null,"Complete the payment")],-1))],64)):(d(),b(E,{key:1},[l(" Use the reference number above to complete your payment through "+n(g.value)+". ",1)],64))]),_:1}),s(x,{color:"primary",class:"mt-4",onClick:B,"prepend-icon":"mdi-content-copy"},{default:i(()=>[...t[12]||(t[12]=[l(" Copy Reference ",-1)])]),_:1})]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(_,{class:"invoice-card"},{default:i(()=>[s(D,{class:"bg-primary text-white pa-6"},{default:i(()=>[e("div",st,[e("div",null,[t[14]||(t[14]=e("h2",{class:"text-h4 font-weight-bold"},"INVOICE",-1)),e("div",ot,n(o.invoice.invoice_number),1)]),e("div",nt,[s(y,{color:S(o.invoice.payment_status),size:"large",variant:"flat",class:"font-weight-bold"},{default:i(()=>[l(n(o.invoice.payment_status),1)]),_:1},8,["color"]),o.invoice.is_overdue?(d(),u(y,{key:0,color:"error",size:"large",class:"ml-2 font-weight-bold"},{default:i(()=>[...t[15]||(t[15]=[l(" OVERDUE ",-1)])]),_:1})):c("",!0)])])]),_:1}),s(C,null,{default:i(()=>[e("div",lt,[e("h3",at,[s(f,{class:"mr-2",color:"primary"},{default:i(()=>[...t[16]||(t[16]=[l("mdi-file-document",-1)])]),_:1}),t[17]||(t[17]=l(" Invoice Information ",-1))]),t[27]||(t[27]=e("hr",{class:"mb-1"},null,-1)),s(p,{dense:""},{default:i(()=>[s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[18]||(t[18]=e("div",{class:"text-caption text-grey mb-1"},"Invoice Number",-1)),e("div",dt,n(o.invoice.invoice_number),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[20]||(t[20]=e("div",{class:"text-caption text-grey mb-1"},"Status",-1)),e("div",null,[s(y,{color:S(o.invoice.payment_status),size:"small",variant:"flat"},{default:i(()=>[l(n(o.invoice.payment_status),1)]),_:1},8,["color"]),o.invoice.is_overdue?(d(),u(y,{key:0,color:"error",size:"small",class:"ml-1"},{default:i(()=>[...t[19]||(t[19]=[l(" OVERDUE ",-1)])]),_:1})):c("",!0)])]),_:1}),s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[21]||(t[21]=e("div",{class:"text-caption text-grey mb-1"},"Issue Date",-1)),e("div",rt,n(o.invoice.issue_date),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[22]||(t[22]=e("div",{class:"text-caption text-grey mb-1"},"Due Date",-1)),e("div",mt,n(o.invoice.due_date||"N/A"),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[23]||(t[23]=e("div",{class:"text-caption text-grey mb-1"},"Amount",-1)),e("div",ct,n(N(o.invoice.amount)),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[24]||(t[24]=e("div",{class:"text-caption text-grey mb-1"},"Paid Amount",-1)),e("div",ut,n(N(o.invoice.paid_amount)),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[25]||(t[25]=e("div",{class:"text-caption text-grey mb-1"},"Remaining Amount",-1)),e("div",vt,n(N(o.invoice.remaining_amount)),1)]),_:1}),s(a,{cols:"12"},{default:i(()=>[t[26]||(t[26]=e("div",{class:"text-caption text-grey mb-1"},"Description",-1)),e("div",yt,n(o.invoice.description||"N/A"),1)]),_:1})]),_:1})]),e("div",ft,[e("h3",xt,[s(f,{class:"mr-2",color:"primary"},{default:i(()=>[...t[28]||(t[28]=[l("mdi-account",-1)])]),_:1}),t[29]||(t[29]=l(" Customer Information ",-1))]),t[34]||(t[34]=e("hr",{class:"mb-1"},null,-1)),s(p,{dense:""},{default:i(()=>[s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[30]||(t[30]=e("div",{class:"text-caption text-grey mb-1"},"Name",-1)),e("div",bt,n(o.invoice.customer.name),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"2"},{default:i(()=>[t[31]||(t[31]=e("div",{class:"text-caption text-grey mb-1"},"Type",-1)),s(y,{size:"small",color:"primary",variant:"tonal"},{default:i(()=>[l(n(o.invoice.customer.type),1)]),_:1})]),_:1}),s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[32]||(t[32]=e("div",{class:"text-caption text-grey mb-1"},"Email",-1)),e("div",gt,n(o.invoice.customer.email||"N/A"),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[33]||(t[33]=e("div",{class:"text-caption text-grey mb-1"},"Phone",-1)),e("div",pt,n(o.invoice.customer.phone||"N/A"),1)]),_:1})]),_:1})]),o.invoice.property?(d(),b("div",wt,[e("h3",kt,[s(f,{class:"mr-2",color:"primary"},{default:i(()=>[...t[35]||(t[35]=[l("mdi-home",-1)])]),_:1}),t[36]||(t[36]=l(" Property Information ",-1))]),s(P,{class:"mb-4"}),s(p,{dense:""},{default:i(()=>[s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[37]||(t[37]=e("div",{class:"text-caption text-grey mb-1"},"Property Number",-1)),e("div",Nt,n(o.invoice.property.number_type)+": "+n(o.invoice.property.number_value),1)]),_:1}),s(a,{cols:"12",sm:"6",md:"4"},{default:i(()=>[t[38]||(t[38]=e("div",{class:"text-caption text-grey mb-1"},"Property Type",-1)),e("div",Pt,n(o.invoice.property.property_type||"N/A"),1)]),_:1}),s(a,{cols:"12",md:"4"},{default:i(()=>[t[39]||(t[39]=e("div",{class:"text-caption text-grey mb-1"},"Address",-1)),e("div",Rt,n(o.invoice.property.address),1)]),_:1})]),_:1})])):c("",!0),e("div",At,[e("h3",It,[s(f,{class:"mr-2",color:"primary"},{default:i(()=>[...t[40]||(t[40]=[l("mdi-cloud-sync",-1)])]),_:1}),t[41]||(t[41]=l(" GIRAS Integration ",-1))]),s(P,{class:"mb-4"}),s(p,{dense:""},{default:i(()=>[s(a,{cols:"12",sm:"6",md:"3"},{default:i(()=>[t[42]||(t[42]=e("div",{class:"text-caption text-grey mb-1"},"Sync Status",-1)),s(y,{color:o.invoice.giras.synced?"success":"grey",size:"small",variant:"flat"},{default:i(()=>[s(f,{start:"",size:"small"},{default:i(()=>[l(n(o.invoice.giras.synced?"mdi-check-circle":"mdi-close-circle"),1)]),_:1}),l(" "+n(o.invoice.giras.synced?"Synced":"Not Synced"),1)]),_:1},8,["color"])]),_:1}),o.invoice.giras.invoice_id?(d(),u(a,{key:0,cols:"12",sm:"6",md:"3"},{default:i(()=>[t[43]||(t[43]=e("div",{class:"text-caption text-grey mb-1"},"GIRAS Invoice ID",-1)),e("div",Ct,n(o.invoice.giras.invoice_id),1)]),_:1})):c("",!0),o.invoice.giras.invoice_number?(d(),u(a,{key:1,cols:"12",sm:"6",md:"3"},{default:i(()=>[t[44]||(t[44]=e("div",{class:"text-caption text-grey mb-1"},"GIRAS Invoice Number",-1)),e("div",_t,n(o.invoice.giras.invoice_number),1)]),_:1})):c("",!0),o.invoice.giras.gateway?(d(),u(a,{key:2,cols:"12",sm:"6",md:"3"},{default:i(()=>[t[45]||(t[45]=e("div",{class:"text-caption text-grey mb-1"},"Gateway",-1)),s(y,{size:"small",color:"info",variant:"tonal",class:"text-uppercase"},{default:i(()=>[l(n(o.invoice.giras.gateway),1)]),_:1})]),_:1})):c("",!0),o.invoice.giras.reference?(d(),u(a,{key:3,cols:"12",sm:"6",md:"4"},{default:i(()=>[t[46]||(t[46]=e("div",{class:"text-caption text-grey mb-1"},"Payment Reference",-1)),e("div",St,n(o.invoice.giras.reference),1)]),_:1})):c("",!0),o.invoice.giras.synced_at?(d(),u(a,{key:4,cols:"12",sm:"6",md:"4"},{default:i(()=>[t[47]||(t[47]=e("div",{class:"text-caption text-grey mb-1"},"Synced At",-1)),e("div",Dt,n(o.invoice.giras.synced_at),1)]),_:1})):c("",!0)]),_:1})]),o.invoice.payments.length>0?(d(),b("div",Et,[e("h3",Gt,[s(f,{class:"mr-2",color:"primary"},{default:i(()=>[...t[48]||(t[48]=[l("mdi-history",-1)])]),_:1}),t[49]||(t[49]=l(" Payment History ",-1))]),s(P,{class:"mb-4"}),s(H,{headers:T,items:o.invoice.payments,"items-per-page":-1,"hide-default-footer":"",class:"elevation-0"},{"item.amount":i(({item:v})=>[l(n(N(v.amount)),1)]),"item.status":i(({item:v})=>[s(y,{color:v.status==="SUCCESS"?"success":v.status==="PENDING"?"warning":"error",size:"small",variant:"flat"},{default:i(()=>[l(n(v.status),1)]),_:2},1032,["color"])]),_:1},8,["items"])])):c("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{ht as default};
