import{A as tt}from"./AdminLayout-DTcn9miB.js";import{d as et,H as it,r as x,q as nt,p as st,a as d,c as m,o as l,w as i,b as s,e,h as r,i as a,f as z,j as b,k as v,t as o,F as V,_ as ot}from"./app-Ckp5YMnG.js";import{G as U}from"./GChip-B_dJgGgs.js";import"./useTheme-B1awz47X.js";const at={class:"d-flex justify-end mb-4 no-print"},lt={key:0,style:{height:"600px"}},dt=["src"],rt={key:1,class:"pa-8 text-center"},ct={class:"mb-4"},ut={class:"text-h6 text-uppercase"},mt={class:"text-caption text-grey"},vt={class:"text-h5 font-weight-bold text-success"},yt={class:"d-flex justify-space-between align-center flex-wrap"},ft={class:"text-h6 mt-2 text-white"},gt={class:"text-right"},xt={class:"mb-6"},pt={class:"text-h6 font-weight-bold mb-2"},bt={class:"text-body-2 text-grey-darken-1"},wt={class:"mb-1"},_t={class:"mb-1"},kt={key:0},ht={class:"text-body-1 font-weight-bold mb-1"},Rt={class:"text-body-2 text-grey-darken-1"},Pt={class:"mb-1"},It={key:0},Nt={class:"text-right font-weight-bold"},Ct={class:"text-right font-weight-bold"},At={key:0},Gt={class:"text-right"},Dt={class:"text-right text-h5 font-weight-bold text-primary"},St={key:0},Et={class:"text-right text-h6 font-weight-bold text-success"},zt={key:1},Vt={class:"text-right text-h6 font-weight-bold text-warning"},Ut={key:0,class:"mb-6 no-print"},Bt={class:"d-flex align-center"},Lt={class:"text-body-2 font-weight-medium"},Ot={class:"text-body-2 font-weight-medium"},Tt={class:"text-body-2 font-weight-medium"},Ft={class:"text-body-2"},jt={key:1,class:"no-print"},Ht=et({__name:"Show",props:{invoice:{}},setup(n){const D=n,B=it(),h=x(!1),w=x(!1),R=x(""),P=x(""),p=x(""),L=nt(()=>{try{return new URL(R.value),!0}catch{return!1}});st(()=>B.props.flash?.paymentData,c=>{c&&(R.value=c.link||c.reference||"",P.value=c.reference||"",p.value=c.gateway||"",w.value=!0)},{immediate:!0});const O=()=>{h.value=!0,b.post(route("admin.invoices.initiate-payment",D.invoice.id),{},{onFinish:()=>{h.value=!1}})},T=()=>{w.value=!1,b.reload()},F=()=>{navigator.clipboard.writeText(P.value),alert("Reference copied to clipboard!")},j=()=>{window.print()},H=c=>{switch(c){case"PAID":return"success";case"PENDING":return"warning";case"OVERDUE":return"error";default:return"grey"}},_=c=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(c),Y=[{title:"Date",key:"payment_date"},{title:"Reference",key:"reference"},{title:"Amount",key:"amount"},{title:"Gateway",key:"gateway"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],I=x(null),$=c=>{I.value=c,b.post(route("admin.invoices.payments.revalidate",{invoice:D.invoice.id,payment:c}),{},{preserveScroll:!0,onFinish:()=>{I.value=null}})};return(c,t)=>{const f=d("v-btn"),S=d("v-card-title"),g=d("v-icon"),k=d("v-divider"),N=d("v-card-text"),C=d("v-card"),q=d("v-alert"),M=d("v-dialog"),A=d("v-chip"),y=d("v-col"),E=d("v-table"),G=d("v-row"),J=d("v-expansion-panel-title"),K=d("v-expansion-panel-text"),Q=d("v-expansion-panel"),W=d("v-expansion-panels"),X=d("v-data-table"),Z=d("v-container");return l(),m(tt,null,{default:i(()=>[s(Z,{fluid:""},{default:i(()=>[e("div",at,[n.invoice.payment_status==="PAID"?(l(),m(f,{key:0,color:"primary","prepend-icon":"mdi-printer",class:"mr-2",onClick:j},{default:i(()=>[...t[3]||(t[3]=[a(" Print Receipt ",-1)])]),_:1})):r("",!0),n.invoice.payment_status!=="PAID"&&n.invoice.giras.synced?(l(),m(f,{key:1,color:"success","prepend-icon":"mdi-credit-card",class:"mr-2",onClick:O,loading:h.value},{default:i(()=>[...t[4]||(t[4]=[a(" Pay Now ",-1)])]),_:1},8,["loading"])):r("",!0),n.invoice.payment_status!=="PAID"?(l(),m(f,{key:2,color:"primary","prepend-icon":"mdi-pencil",class:"mr-2",onClick:t[0]||(t[0]=u=>z(b).visit(c.route("admin.invoices.edit",n.invoice.id)))},{default:i(()=>[...t[5]||(t[5]=[a(" Edit ",-1)])]),_:1})):r("",!0),s(f,{variant:"text","prepend-icon":"mdi-arrow-left",onClick:t[1]||(t[1]=u=>z(b).visit(c.route("admin.invoices.index")))},{default:i(()=>[...t[6]||(t[6]=[a(" Back ",-1)])]),_:1})]),s(M,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=u=>w.value=u),"max-width":"900",persistent:"",class:"no-print"},{default:i(()=>[s(C,null,{default:i(()=>[s(S,{class:"d-flex justify-space-between align-center bg-success"},{default:i(()=>[t[7]||(t[7]=e("span",{class:"text-white"},"Payment Gateway",-1)),s(f,{icon:"mdi-close",variant:"text",color:"white",onClick:T})]),_:1}),s(N,{class:"pa-0"},{default:i(()=>[L.value?(l(),v("div",lt,[e("iframe",{src:R.value,style:{width:"100%",height:"100%",border:"none"},title:"Payment Gateway"},null,8,dt)])):(l(),v("div",rt,[s(g,{size:"64",color:"success",class:"mb-4"},{default:i(()=>[...t[8]||(t[8]=[a("mdi-check-circle",-1)])]),_:1}),t[13]||(t[13]=e("h2",{class:"text-h5 mb-4"},"Payment Reference Generated",-1)),s(C,{variant:"outlined",class:"mb-4"},{default:i(()=>[s(N,null,{default:i(()=>[e("div",ct,[t[9]||(t[9]=e("div",{class:"text-caption text-grey"},"Gateway",-1)),e("div",ut,o(p.value),1)]),s(k,{class:"my-4"}),e("div",null,[e("div",mt,o(p.value==="remita"?"RRR Number":"Reference"),1),e("div",vt,o(P.value),1)])]),_:1})]),_:1}),s(q,{type:"info",variant:"tonal",class:"text-left"},{default:i(()=>[p.value==="remita"?(l(),v(V,{key:0},[t[10]||(t[10]=e("strong",null,"How to Pay:",-1)),t[11]||(t[11]=e("ol",{class:"mt-2"},[e("li",null,"Visit any bank or use your bank's mobile app"),e("li",null,'Select "Remita Payment"'),e("li",null,"Enter the RRR number above"),e("li",null,"Complete the payment")],-1))],64)):(l(),v(V,{key:1},[a(" Use the reference number above to complete your payment through "+o(p.value)+". ",1)],64))]),_:1}),s(f,{color:"primary",class:"mt-4",onClick:F,"prepend-icon":"mdi-content-copy"},{default:i(()=>[...t[12]||(t[12]=[a(" Copy Reference ",-1)])]),_:1})]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(C,{class:"invoice-card",id:"invoice-print-area"},{default:i(()=>[s(S,{class:"bg-primary text-white pa-6"},{default:i(()=>[e("div",yt,[e("div",null,[t[14]||(t[14]=e("h2",{class:"text-h4 font-weight-bold text-white"},"INVOICE",-1)),e("div",ft,o(n.invoice.invoice_number),1)]),e("div",gt,[s(U,{color:H(n.invoice.payment_status),size:"large",variant:"flat",class:"font-weight-bold text-white"},{default:i(()=>[a(o(n.invoice.payment_status),1)]),_:1},8,["color"]),n.invoice.is_overdue?(l(),m(U,{key:0,color:"error",size:"large",class:"ml-2 font-weight-bold"},{default:i(()=>[...t[15]||(t[15]=[a(" OVERDUE ",-1)])]),_:1})):r("",!0)])])]),_:1}),s(N,{class:"pa-6"},{default:i(()=>[s(G,{class:"mb-6"},{default:i(()=>[s(y,{cols:"12",md:"6"},{default:i(()=>[e("div",xt,[t[18]||(t[18]=e("h3",{class:"text-subtitle-1 font-weight-bold text-grey-darken-2 mb-3"},"BILL TO:",-1)),e("div",pt,o(n.invoice.customer.name),1),e("div",bt,[e("div",wt,[s(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[16]||(t[16]=[a("mdi-email",-1)])]),_:1}),a(o(n.invoice.customer.email||"N/A"),1)]),e("div",_t,[s(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[17]||(t[17]=[a("mdi-phone",-1)])]),_:1}),a(o(n.invoice.customer.phone||"N/A"),1)]),e("div",null,[s(A,{size:"x-small",class:"mt-1"},{default:i(()=>[a(o(n.invoice.customer.type),1)]),_:1})])])]),n.invoice.property?(l(),v("div",kt,[t[21]||(t[21]=e("h3",{class:"text-subtitle-1 font-weight-bold text-grey-darken-2 mb-3"},"PROPERTY:",-1)),e("div",ht,o(n.invoice.property.number_type)+": "+o(n.invoice.property.number_value),1),e("div",Rt,[e("div",Pt,[s(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[19]||(t[19]=[a("mdi-map-marker",-1)])]),_:1}),a(o(n.invoice.property.address),1)]),n.invoice.property.property_type?(l(),v("div",It,[s(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[20]||(t[20]=[a("mdi-home-variant",-1)])]),_:1}),a(o(n.invoice.property.property_type),1)])):r("",!0)])])):r("",!0)]),_:1}),s(y,{cols:"12",md:"6"},{default:i(()=>[s(E,{density:"compact",class:"invoice-details-table"},{default:i(()=>[e("tbody",null,[e("tr",null,[t[22]||(t[22]=e("td",{class:"text-grey-darken-1 font-weight-medium"},"Issue Date:",-1)),e("td",Nt,o(n.invoice.issue_date),1)]),e("tr",null,[t[23]||(t[23]=e("td",{class:"text-grey-darken-1 font-weight-medium"},"Due Date:",-1)),e("td",Ct,o(n.invoice.due_date||"N/A"),1)]),n.invoice.description?(l(),v("tr",At,[t[24]||(t[24]=e("td",{class:"text-grey-darken-1 font-weight-medium"},"Description:",-1)),e("td",Gt,o(n.invoice.description),1)])):r("",!0)])]),_:1})]),_:1})]),_:1}),s(k,{class:"my-6"}),s(G,{class:"mb-6"},{default:i(()=>[s(y,{cols:"12"},{default:i(()=>[s(E,{class:"amount-summary-table"},{default:i(()=>[e("tbody",null,[e("tr",null,[t[25]||(t[25]=e("td",{class:"text-h6 font-weight-medium"},"Invoice Amount:",-1)),e("td",Dt,o(_(n.invoice.amount)),1)]),n.invoice.paid_amount>0?(l(),v("tr",St,[t[26]||(t[26]=e("td",{class:"text-body-1 font-weight-medium text-success"},"Paid Amount:",-1)),e("td",Et,o(_(n.invoice.paid_amount)),1)])):r("",!0),n.invoice.remaining_amount>0?(l(),v("tr",zt,[t[27]||(t[27]=e("td",{class:"text-body-1 font-weight-medium text-warning"},"Remaining Amount:",-1)),e("td",Vt,o(_(n.invoice.remaining_amount)),1)])):r("",!0)])]),_:1})]),_:1})]),_:1}),n.invoice.giras.synced?(l(),v("div",Ut,[s(k,{class:"mb-4"}),s(W,{variant:"accordion"},{default:i(()=>[s(Q,null,{default:i(()=>[s(J,null,{default:i(()=>[e("div",Bt,[s(g,{class:"mr-2",color:"success"},{default:i(()=>[...t[28]||(t[28]=[a("mdi-cloud-check",-1)])]),_:1}),t[29]||(t[29]=e("span",{class:"font-weight-medium"},"GIRAS Integration Details",-1))])]),_:1}),s(K,null,{default:i(()=>[s(G,{dense:""},{default:i(()=>[n.invoice.giras.invoice_id?(l(),m(y,{key:0,cols:"6",sm:"4"},{default:i(()=>[t[30]||(t[30]=e("div",{class:"text-caption text-grey"},"GIRAS Invoice ID",-1)),e("div",Lt,o(n.invoice.giras.invoice_id),1)]),_:1})):r("",!0),n.invoice.giras.invoice_number?(l(),m(y,{key:1,cols:"6",sm:"4"},{default:i(()=>[t[31]||(t[31]=e("div",{class:"text-caption text-grey"},"GIRAS Invoice Number",-1)),e("div",Ot,o(n.invoice.giras.invoice_number),1)]),_:1})):r("",!0),n.invoice.giras.gateway?(l(),m(y,{key:2,cols:"6",sm:"4"},{default:i(()=>[t[32]||(t[32]=e("div",{class:"text-caption text-grey"},"Gateway",-1)),s(A,{size:"x-small",color:"info",class:"text-uppercase"},{default:i(()=>[a(o(n.invoice.giras.gateway),1)]),_:1})]),_:1})):r("",!0),n.invoice.giras.reference?(l(),m(y,{key:3,cols:"6",sm:"4"},{default:i(()=>[t[33]||(t[33]=e("div",{class:"text-caption text-grey"},"Reference",-1)),e("div",Tt,o(n.invoice.giras.reference),1)]),_:1})):r("",!0),n.invoice.giras.synced_at?(l(),m(y,{key:4,cols:"6",sm:"4"},{default:i(()=>[t[34]||(t[34]=e("div",{class:"text-caption text-grey"},"Synced At",-1)),e("div",Ft,o(n.invoice.giras.synced_at),1)]),_:1})):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])):r("",!0),n.invoice.payments.length>0?(l(),v("div",jt,[s(k,{class:"mb-4"}),t[36]||(t[36]=e("h3",{class:"text-subtitle-1 font-weight-bold text-grey-darken-2 mb-3"},"PAYMENT HISTORY",-1)),s(X,{headers:Y,items:n.invoice.payments,"items-per-page":-1,"hide-default-footer":"",density:"compact"},{"item.amount":i(({item:u})=>[a(o(_(u.amount)),1)]),"item.status":i(({item:u})=>[s(A,{color:u.status==="SUCCESS"?"success":u.status==="PENDING"?"warning":"error",size:"x-small",variant:"flat"},{default:i(()=>[a(o(u.status),1)]),_:2},1032,["color"])]),"item.actions":i(({item:u})=>[u.status==="PENDING"?(l(),m(f,{key:0,color:"primary",size:"x-small",variant:"text","prepend-icon":"mdi-refresh",onClick:Yt=>$(u.id),loading:I.value===u.id},{default:i(()=>[...t[35]||(t[35]=[a(" Revalidate ",-1)])]),_:1},8,["onClick","loading"])):r("",!0)]),_:1},8,["items"])])):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Kt=ot(Ht,[["__scopeId","data-v-70025a16"]]);export{Kt as default};
